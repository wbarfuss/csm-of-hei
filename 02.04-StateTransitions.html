<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; State transitions – Complex Systems Modeling of Human-Environment Interactions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-TargetEquilibria.html" rel="next">
<link href="./02.03-Resilience.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7f1cf6fc70090d11f60898f9e7f80fa6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-DynamicSystems.html">Dynamic Systems</a></li><li class="breadcrumb-item"><a href="./02.04-StateTransitions.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">State transitions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/CSMofHEI_Logo.drawio.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Complex Systems Modeling of Human-Environment Interactions</a> 
        <div class="sidebar-tools-main">
    <a href="./Complex-Systems-Modeling-of-Human-Environment-Interactions.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.01-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intoduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-DynamicSystems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.01-Nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Nonlinearity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.02-TippingElements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tipping elements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.03-Resilience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resilience</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.04-StateTransitions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">State transitions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-TargetEquilibria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Target Equilibria</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.01-SequentialDecisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sequential Decisions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.02-StrategicInteractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Strategic Interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.03-DynamicInteractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Interactions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-TransformationAgency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformation Agency</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.01-BehavioralAgency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Behavioral agency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.02-IndividualLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Individual learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.03-LearningDynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Learning dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.02ex-IntroToPython.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Introduction to Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.01ex-Nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Nonlinearity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.02ex-TippingElements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Tipping elements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.03ex-Resilience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Resilience</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.04ex-StateTransitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | State transitions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.01ex-SequentialDecisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Sequential Decisions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.02ex-StrategicInteractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Strategic Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.03ex-DynamicInteractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Dynamic Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.01ex-BehavioralAgency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Behavioral Agency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.02ex-IndividualLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Individual Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.03ex-LearningDynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ex | Learning Dynamics</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation-state-transitions-models" id="toc-motivation-state-transitions-models" class="nav-link active" data-scroll-target="#motivation-state-transitions-models"><span class="header-section-number">5.1</span> Motivation | <strong>State-transitions</strong> models</a>
  <ul class="collapse">
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link" data-scroll-target="#learning-goals"><strong>Learning goals</strong></a></li>
  </ul></li>
  <li><a href="#markov-chains" id="toc-markov-chains" class="nav-link" data-scroll-target="#markov-chains"><span class="header-section-number">5.2</span> Markov chains</a>
  <ul class="collapse">
  <li><a href="#a-simple-example" id="toc-a-simple-example" class="nav-link" data-scroll-target="#a-simple-example">A simple example</a></li>
  <li><a href="#computational-model" id="toc-computational-model" class="nav-link" data-scroll-target="#computational-model">Computational model</a></li>
  </ul></li>
  <li><a href="#simulations" id="toc-simulations" class="nav-link" data-scroll-target="#simulations"><span class="header-section-number">5.3</span> Simulations</a>
  <ul class="collapse">
  <li><a href="#a-single-simulation-run" id="toc-a-single-simulation-run" class="nav-link" data-scroll-target="#a-single-simulation-run">A single simulation run</a></li>
  <li><a href="#ensemble-simulation" id="toc-ensemble-simulation" class="nav-link" data-scroll-target="#ensemble-simulation">Ensemble simulation</a></li>
  <li><a href="#markov-chain-update" id="toc-markov-chain-update" class="nav-link" data-scroll-target="#markov-chain-update">Markov chain <strong>update</strong></a></li>
  <li><a href="#state-distribution-evolution" id="toc-state-distribution-evolution" class="nav-link" data-scroll-target="#state-distribution-evolution">State distribution evolution</a></li>
  </ul></li>
  <li><a href="#stationary-distribution" id="toc-stationary-distribution" class="nav-link" data-scroll-target="#stationary-distribution"><span class="header-section-number">5.4</span> Stationary distribution</a>
  <ul class="collapse">
  <li><a href="#numerical-stationary-distribution" id="toc-numerical-stationary-distribution" class="nav-link" data-scroll-target="#numerical-stationary-distribution">Numerical <strong>stationary distribution</strong></a></li>
  <li><a href="#analytical-stationary-distribution" id="toc-analytical-stationary-distribution" class="nav-link" data-scroll-target="#analytical-stationary-distribution">Analytical <strong>stationary distribution</strong></a></li>
  <li><a href="#stationary-distribution-existence" id="toc-stationary-distribution-existence" class="nav-link" data-scroll-target="#stationary-distribution-existence">Stationary distribution | <strong>Existence</strong></a></li>
  </ul></li>
  <li><a href="#transient-behavior" id="toc-transient-behavior" class="nav-link" data-scroll-target="#transient-behavior"><span class="header-section-number">5.5</span> Transient behavior</a>
  <ul class="collapse">
  <li><a href="#simulating-different-transition-probabilities" id="toc-simulating-different-transition-probabilities" class="nav-link" data-scroll-target="#simulating-different-transition-probabilities">Simulating different transition probabilities</a></li>
  <li><a href="#visualizing-distribution-trajectories" id="toc-visualizing-distribution-trajectories" class="nav-link" data-scroll-target="#visualizing-distribution-trajectories">Visualizing distribution trajectories</a></li>
  </ul></li>
  <li><a href="#timescales" id="toc-timescales" class="nav-link" data-scroll-target="#timescales"><span class="header-section-number">5.6</span> Timescales</a>
  <ul class="collapse">
  <li><a href="#numerical-computation" id="toc-numerical-computation" class="nav-link" data-scroll-target="#numerical-computation">Numerical computation</a></li>
  <li><a href="#analytical-computation" id="toc-analytical-computation" class="nav-link" data-scroll-target="#analytical-computation">Analytical computation</a></li>
  <li><a href="#example-regime-shifts-timescales" id="toc-example-regime-shifts-timescales" class="nav-link" data-scroll-target="#example-regime-shifts-timescales">Example | <strong>Regime shifts timescales</strong></a></li>
  </ul></li>
  <li><a href="#learning-goals-revisited" id="toc-learning-goals-revisited" class="nav-link" data-scroll-target="#learning-goals-revisited"><span class="header-section-number">5.7</span> Learning goals <strong>revisited</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-DynamicSystems.html">Dynamic Systems</a></li><li class="breadcrumb-item"><a href="./02.04-StateTransitions.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">State transitions</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">State transitions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://wbarfuss.github.io">Wolfram Barfuss</a> | <a href="https://www.uni-bonn.de">University of Bonn</a> | 2024/2025 <br> ▶ <strong>Complex Systems Modeling of Human-Environment Interactions</strong></p>
<section id="motivation-state-transitions-models" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="motivation-state-transitions-models"><span class="header-section-number">5.1</span> Motivation | <strong>State-transitions</strong> models</h2>
<p><strong>State-and-transition models</strong> are useful tools to explain the causes and consequences of ecosystem change.</p>
<p><a href="#fig-state-transition-model-in-mongolia" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> shows a state-transition model of sandy-loamy alluvails soils in the dry steppe of eastern central Mongolia.</p>
<div id="fig-state-transition-model-in-mongolia" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-state-transition-model-in-mongolia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/02.04-MongoliaStateTransitionModel.dio.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-state-transition-model-in-mongolia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: State transitions in the dry steppe of Mongolia
</figcaption>
</figure>
</div>
<p>The model describes the dynamics of the vegetation in the region. The vegetation can be in one of four states: a <em>reference state</em>, <em>Forb decreased state</em>, <em>Stipa grandis decreased state</em>, or <em>Degraded state</em>. The arrows indicate the possible transitions between the states <span class="citation" data-cites="BiggsEtAl2021">(<a href="References.html#ref-BiggsEtAl2021" role="doc-biblioref">Biggs et al., 2021</a>)</span>.</p>
<p><a href="#fig-land-cover-transitions-in-brazil" class="quarto-xref">Figure&nbsp;<span>5.2</span></a> shows possible state transitions between states of different land cover types in the Brazilian Amazon.</p>
<div id="fig-land-cover-transitions-in-brazil" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-land-cover-transitions-in-brazil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/02.04-BrazilStateTransitionModel.dio.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-land-cover-transitions-in-brazil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Land-cover transitions in Brazilian Amazon
</figcaption>
</figure>
</div>
<p>The thickness of the arrows indicates the probability of the transition. The land cover can be in one of five states: <em>Annual crops</em>, <em>Forest</em>, <em>Dirty Pasture</em>, <em>Clean Pasture</em>, <em>Secondary Vegetation</em>, plus an <em>Other</em> state representing all other possible land cover types <span class="citation" data-cites="Muller-HansenEtAl2017a">(<a href="References.html#ref-Muller-HansenEtAl2017a" role="doc-biblioref">Müller-Hansen et al., 2017</a>)</span>.</p>
<p>State-and-transition models are <strong>often co-developed with stakeholders</strong> and are used as <strong>heuristic tools</strong> to understand the dynamics of ecosystems. They are also used in <strong>scenario development</strong> to explore possible futures.</p>
<p>Note, that terms such as <em>state-and-transition model</em> and <em>transition model</em> have been widely used in the literature without a clear, formal definition <span class="citation" data-cites="DanielEtAl2016">(<a href="References.html#ref-DanielEtAl2016" role="doc-biblioref">Daniel et al., 2016</a>)</span>.</p>
<p>There are <strong>various computational variants</strong> of state-and-transition models. The simplest and most basic model is the one of a <strong>Markov Chain</strong>.</p>
<section id="learning-goals" class="level3">
<h3 class="anchored" data-anchor-id="learning-goals"><strong>Learning goals</strong></h3>
<p>After this lecture, students will be able to:</p>
<ul>
<li><strong>Name</strong> and <strong>explain</strong> the <em>components of a Markov chain model</em> and how the model relates to gernal dynamic system models to embed this model in the context of integrated nature-society models.</li>
<li><strong>Simulate</strong> and <strong>visualize</strong> <em>Markov chain models</em> stochastically, with ensembles, and via its state distribution</li>
<li><strong>Compute</strong> the <em>stationary distribution</em> of a Markov chain model numerically, analytically and explain the conditions for its existence to understand the long-term behavior of the model.</li>
<li><strong>Investigate</strong> the <em>transient behavior</em> of a Markov chain model to understand the short-term behavior of the model.</li>
<li><strong>Compute</strong> the <em>typical timesacle</em> of a Marko chain transition to relate the model to real-world systems.</li>
</ul>
</section>
</section>
<section id="markov-chains" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="markov-chains"><span class="header-section-number">5.2</span> Markov chains</h2>
<p>Markov chains model systems that transition probabilistically between a finite set of states.</p>
<p>In fact, Markov chains are a very general model that can be applied to all kinds of transitions. For example, a political system might transition between democratic and dictatorial, a market between volatile and stable regimes, or a person between happy, contemplative, anxious, and sad <span class="citation" data-cites="Page2018">(<a href="References.html#ref-Page2018" role="doc-biblioref">Page, 2018, Chapter 17</a>)</span>.</p>
<p>The movements between states occur according to fixed probabilities. The probability that a country transitions from authoritarian to democratic in a given year might be 5%; the likelihood that a person transitions from anxious to tired within an hour maybe 20%.</p>
<p>Named after Russian mathematician Andrey Markov, the essential element of the model is the <strong>Markov property</strong>. This property states that the probability of transitioning to any particular state <strong>depends solely on the current state</strong> and not on the history of states that preceded it.</p>
<p>More formally, we define a Markov chain by the following elements:</p>
<ul>
<li>A discrete set of states <span class="math inline">\(\mathcal S = \{S_1, S_2, \ldots, S_Z\}\)</span>.</li>
<li>A transition matrix <span class="math inline">\(\mathbf T\)</span> with transition probabilities <span class="math inline">\(T(i,j)\)</span>, for <span class="math inline">\(1 &lt; i,j &lt; Z\)</span>, where <span class="math inline">\(T(i,j)\)</span> is the probability of transitioning from state <span class="math inline">\(S_i\)</span> to state <span class="math inline">\(S_j\)</span>.</li>
<li>A disscrete-time index <span class="math inline">\(t=0,1,2,\dots\)</span>.</li>
<li>An initial state distribution <span class="math inline">\(\mathbf p_0 = \big(p_0(S_1), p_0(S_2), \dots, p_0(S_Z) \big)\)</span>, with <span class="math inline">\(p_t(s)\)</span> denoting the probability or fraction of state <span class="math inline">\(s \in \mathcal S\)</span> at time <span class="math inline">\(t\)</span>.</li>
</ul>
<p>Thus, the transition matrix <span class="math inline">\(\mathbf T\)</span> is a square matrix of size <span class="math inline">\(Z \times Z\)</span> with <span class="math inline">\(\sum_{s'} T(s, s') = 1\)</span>, where <span class="math inline">\(s\)</span> denotes the current, and <span class="math inline">\(s'\)</span> the next state. Transition probabilites have to sum up to 1. We must go somewhere.</p>
<section id="a-simple-example" class="level3">
<h3 class="anchored" data-anchor-id="a-simple-example">A simple example</h3>
<p>Let us consider a simple example of a Markov chain with two states modeling a prosperous and a degraded state of Nature.</p>
<div id="fig-simple-markov-chain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/02.04-SimpleExample.dio.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-markov-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: A simple Markov chain
</figcaption>
</figure>
</div>
</section>
<section id="computational-model" class="level3">
<h3 class="anchored" data-anchor-id="computational-model">Computational model</h3>
<p>Let us convert the mathematical into computationa model in Python. We start by importing the necessary libraries and setting up the plotting environment.</p>
<div id="5db3eb2b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.style <span class="im">as</span> style<span class="op">;</span> style.use(<span class="st">'seaborn-v0_8'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="fl">7.8</span>, <span class="fl">2.5</span>)<span class="op">;</span> plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> plt.rcParams[<span class="st">'axes.prop_cycle'</span>].by_key()[<span class="st">'color'</span>][<span class="dv">0</span>]  <span class="co"># get the first color of the default color cycle</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.facecolor'</span>] <span class="op">=</span> <span class="st">'white'</span><span class="op">;</span> plt.rcParams[<span class="st">'grid.color'</span>] <span class="op">=</span> <span class="st">'gray'</span><span class="op">;</span> plt.rcParams[<span class="st">'grid.linewidth'</span>] <span class="op">=</span> <span class="fl">0.25</span><span class="op">;</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But how to model the transition?</p>
<p><strong>Transition matrix</strong>. We know that a the rows of our transition matrix have to sum up to one, <span class="math inline">\(\sum_{s'} T(s, s') = 1\)</span>. Thus, we can simplify the transition matrix by only giving a collpase probability <span class="math inline">\(p_c\)</span> and a recovery probability <span class="math inline">\(p_r\)</span>,</p>
<p><span class="math display">\[
\left(\begin{array}{cc}
    T(\mathsf{p,p}) &amp; T(\mathsf{p,d}) \\
    T(\mathsf{d,p}) &amp; T(\mathsf{d,d}) \\
\end{array}\right)
=
\left(\begin{array}{cc}
    1-p_c &amp; p_c \\
    p_r &amp; 1-p_r \\
\end{array}\right).
\]</span></p>
<p>Lets fix the values for the transition probabilities <span class="math inline">\(p_c\)</span> and <span class="math inline">\(p_r\)</span>, for now,</p>
<div id="ce02566b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pc <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pr <span class="op">=</span> <span class="fl">0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can implement the transition matrix as a two-dimensional numpy array,</p>
<div id="23b50c0b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.array([[<span class="dv">1</span><span class="op">-</span>pc, pc],</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>              [pr, <span class="dv">1</span><span class="op">-</span>pr]])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>array([[0.95, 0.05],
       [0.01, 0.99]])</code></pre>
</div>
</div>
</section>
</section>
<section id="simulations" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="simulations"><span class="header-section-number">5.3</span> Simulations</h2>
<section id="a-single-simulation-run" class="level3">
<h3 class="anchored" data-anchor-id="a-single-simulation-run">A single simulation run</h3>
<p>Considering the system to be in exaclty one of its states at each time step, we can <strong>simulate</strong> the Markov chain <strong>stochastically</strong> by choosing the next state (using <code>numpy.random.choice</code>) according to the transition probabilites as given in the transition matrix (by specifing the probabilities as <code>p=TransitionMatrix[current_state]</code>).</p>
<div id="d9d69b79" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_markov_chain(TransitionMatrix, InitialState, NrTimeSteps):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    trajetory <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">*</span>np.ones(NrTimeSteps, dtype<span class="op">=</span><span class="bu">int</span>)    </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    trajetory[<span class="dv">0</span>] <span class="op">=</span> InitialState</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, NrTimeSteps):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        trajetory[t] <span class="op">=</span> np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], <span class="co"># sample next state </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                        p<span class="op">=</span>TransitionMatrix[trajetory[t<span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trajetory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizing the results, we can see how the system evolves over time.</p>
<div id="9dfd79b3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1818</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>trajectory <span class="op">=</span> simulate_markov_chain(T, <span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span><span class="op">-</span>np.array(trajectory), ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'purple'</span>)<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time steps $t$'</span>)<span class="op">;</span> plt.ylabel(<span class="st">'System state $s$'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02.04-StateTransitions_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This stochastic simulation of a <strong>single run</strong> has a strong <strong>resemblance</strong> to the previous dynamic system models we introduced. We can interpret the Markovian states as the stable equilibirum points of dynamic system with nonlinear changes and noise (see <a href="#fig-noise-induced-transitions" class="quarto-xref">Figure&nbsp;<span>5.4</span></a> from <a href="./02.03-Resilience.html">02.03-Resilience</a>).</p>
<div id="fig-noise-induced-transitions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-noise-induced-transitions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/02.04-NoiseInducedTransitions.dio.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-noise-induced-transitions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Noise induced transitions
</figcaption>
</figure>
</div>
<p>However, due to the stochastic nature of the Markov chain, it is hard to judge the system’s behavior from a single run. We need to <strong>average over many runs</strong> to get a clearer picture of the system’s behavior.</p>
</section>
<section id="ensemble-simulation" class="level3">
<h3 class="anchored" data-anchor-id="ensemble-simulation">Ensemble simulation</h3>
<p>Let’s repeat the previous simulation to create an <strong>ensemble of stochastic simulation runs</strong>. Let’s assume we want an ensemble of 100 runs.</p>
<div id="525199f2" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ensemble <span class="op">=</span> []</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    trajectory <span class="op">=</span> simulate_markov_chain(T, state, <span class="dv">500</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ensemble.append(trajectory)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ensemble <span class="op">=</span> np.array(ensemble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is always a good idea to investigate the object one has just created for consistency, for instance, checking the shape of the ensemble.</p>
<div id="c35550e2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ensemble.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(100, 500)</code></pre>
</div>
</div>
<p>The first dimension of the ensemble is the number of runs, the second dimension is the number of time steps.</p>
<p>Visualizing the ensemble by takeing the mean over the first dimension (using <code>ensemble.mean(axis=0)</code>),</p>
<div id="2a7a5eb6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ensemble.mean(axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(500,)</code></pre>
</div>
</div>
<p>we can see how the system evolves over time on average.</p>
<div id="efdaa5b6" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span><span class="op">-</span>ensemble.mean(<span class="dv">0</span>), ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)<span class="op">;</span> plt.xlabel(<span class="st">'Time steps $t$'</span>)<span class="op">;</span> plt.ylabel(<span class="st">'Average system state $s$'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02.04-StateTransitions_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We observe two phases. First a drop. Second, some fluctuations around approx. 0.2.</p>
<p>Thus, after around 50-100 iterations, the system is in approximatly 20 of 100 runs in the the prosperous state.</p>
<p>This is the <strong>statistical equlibirum</strong> or the <strong>long-run stationary distribution</strong> of the Markov chain.</p>
<p>Calculating ensembles is computationlly expensive. <strong>Can we make the computation more efficient?</strong> To do so, we investigate how to update the state distribution of the Markov chain at each time step.</p>
</section>
<section id="markov-chain-update" class="level3">
<h3 class="anchored" data-anchor-id="markov-chain-update">Markov chain <strong>update</strong></h3>
<p>A Markov chain <strong>update</strong> can be nicely <strong>represented by a matrix operation</strong>. The new state <span class="math inline">\(\mathbf p_{t+1}\)</span> equals the old state <span class="math inline">\(\mathbf p_t\)</span> applied to the transition matrix <span class="math inline">\(\mathbf T\)</span>,</p>
<p><span class="math display">\[
\mathbf p_{t+1} = \mathbf p_t \mathbf T.
\]</span></p>
<p>We write the state distribution <span class="math inline">\(\mathbf p_t\)</span> before the transition matrix <span class="math inline">\(\mathbf T\)</span> on the right hand side to indicate the flow of information from left to right. We can also write this as follows, <span class="math display">\[
p_{t+1}({s'}) = \sum_s p_t(s) T(s, s'),
\]</span> where <span class="math inline">\(s\)</span> denotes the current, and <span class="math inline">\(s'\)</span> the next state. The next system state <span class="math inline">\(s'\)</span> depends on the current state <span class="math inline">\(s\)</span> and the transition from <span class="math inline">\(s\)</span> to <span class="math inline">\(s'\)</span> as given by the transition matrix <span class="math inline">\(\mathbf T\)</span>.</p>
<p>Transposing the transition matrix, we can rewrite the Markov chain update as <span class="math inline">\(p_{t+1}(s') = \sum_s T^\mathrm{T}(s',s) p_t(s)\)</span> or</p>
<p><span class="math display">\[
\mathbf p_{t+1} = \mathbf T^\mathrm{T} \mathbf p_t
\]</span></p>
<p>where <span class="math inline">\(\mathbf T^\mathrm{T}\)</span> is the transpose of the transition matrix. Rewriting this update as such highlights the fact that Markov chains can be intepreted as a <strong>special kind of dynamic system</strong> with linear changes (see <a href="./02.01-Nonlinearity.html">02.01-Nonlinearity</a>) but with one additional property. The sum of all variables is always one.</p>
</section>
<section id="state-distribution-evolution" class="level3">
<h3 class="anchored" data-anchor-id="state-distribution-evolution">State distribution evolution</h3>
<p>We use the matrix update to simulate how the state distribution evolves.</p>
<div id="0bbb81ea" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]  <span class="co"># initial state distribution</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>p_trajectory <span class="op">=</span> [ps] <span class="co"># store the state distribution over time</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>): </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    ps <span class="op">=</span> ps <span class="op">@</span> T  <span class="co"># matrix update for the state distribution</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    p_trajectory.append(ps)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>p_trajectory <span class="op">=</span> np.array(p_trajectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The trajectory of the state distribution has the number of time steps as the first dimension and the number of states as the second dimension.</p>
<div id="1cac7e83" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_trajectory.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(501, 2)</code></pre>
</div>
</div>
<p>Since the state distribution is a probability distribution, the sum of all states at each time step should be one. We can check this by summing over the states at each time step.</p>
<div id="3aad329f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>np.allclose(p_trajectory.<span class="bu">sum</span>(axis<span class="op">=-</span><span class="dv">1</span>), <span class="fl">1.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>True</code></pre>
</div>
</div>
<p>Visualizing the state distribution evolution together with the ensemble average reveals a close resembles between the two.</p>
<div id="770fedcc" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span><span class="op">-</span>ensemble.mean(<span class="dv">0</span>), ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Ensemble average'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.plot(p_trajectory[:, <span class="dv">0</span>], ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'State distribution'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time steps $t$'</span>)<span class="op">;</span> plt.ylabel(<span class="st">'Average system state $s$'</span>)<span class="op">;</span> plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02.04-StateTransitions_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The fluctuations of the ensemble average around the long-run stationary distribution are due to the finite number of runs in the ensemble. The more runs we have, the closer the ensemble average will be to the long-run stationary distribution.</p>
<p>The flat line of the state distribution evolution indicates that the system has reached a <strong>statistical equilibirum</strong>.</p>
<p>For example, a statistical equilibrium in a Markov model of ideology would allow for people to transition between liberal, conservative, and independent, but the proportions of people of each ideology would remain unchanged. When applied to a single entity, a statistical equilibrium means that long-run probability of the entity being in each state does not change. A person could be in a statistical equilibrium in which he is happy 60% of the time and sad 40% of the time. The person’s mental state could change from hour to hour, but his long-run distribution across those states does not <span class="citation" data-cites="Page2018">(<a href="References.html#ref-Page2018" role="doc-biblioref">Page, 2018</a>)</span>.</p>
<p>However, can we <strong>compute the stationary distribution somehow directly</strong>?</p>
</section>
</section>
<section id="stationary-distribution" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="stationary-distribution"><span class="header-section-number">5.4</span> Stationary distribution</h2>
<p>After showing how to compute the stationary distribution directly, we will first, compute it <strong>numerically</strong>, second, compute it <strong>symbolically</strong>, and last, we will discuss the conditions for its <strong>existence</strong>.</p>
<p>From the update equation, <span class="math display">\[
\mathbf p_{t+1} = \mathbf p_t \mathbf T.
\]</span> we know that the stationary distribution <span class="math inline">\(\mathbf p^*\)</span> must satisfy, <span class="math display">\[
\mathbf p^* = \mathbf p^* \mathbf T
\]</span></p>
<p>This looks like the defining equation of a (left) <strong>eigenvector</strong> with the eigenvalue 1, <span class="math display">\[
1 \mathbf  p^* = \mathbf p^* \mathbf T
\]</span></p>
<section id="numerical-stationary-distribution" class="level3">
<h3 class="anchored" data-anchor-id="numerical-stationary-distribution">Numerical <strong>stationary distribution</strong></h3>
<p>Fortunately, <code>numpy</code> has built-in routine to compute the eigenvectors of a matrix. Since the standard routine <code>np.linalg.eig</code> only computes the right eigenvectors, we need to apply the routine to the transposed matrix:</p>
<div id="b3d87569" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>eigvv <span class="op">=</span> np.linalg.eig(T.T)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>eigvv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>EigResult(eigenvalues=array([0.94, 1.  ]), eigenvectors=array([[-0.70710678, -0.19611614],
       [ 0.70710678, -0.98058068]]))</code></pre>
</div>
</div>
<div id="1ce54606" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;slideshow&quot;,&quot;value&quot;:{&quot;slide_type&quot;:&quot;fragment&quot;}}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>eigvv[<span class="dv">1</span>][:,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([-0.19611614, -0.98058068])</code></pre>
</div>
</div>
<p>Normalizing the eigenvector, such that it entries comprise a probability distribution, yields</p>
<div id="3a9c96cc" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pstar <span class="op">=</span> eigvv[<span class="dv">1</span>][:,<span class="dv">1</span>] <span class="op">/</span> <span class="bu">sum</span>(eigvv[<span class="dv">1</span>][:,<span class="dv">1</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pstar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([0.16666667, 0.83333333])</code></pre>
</div>
</div>
<p>Visualizing the stationary state distribution together with the state distribution evolution and the ensemble average reveals that the calculated stationary distribution fits perfectly to the distribution evolution in (statistical) equilibirum.</p>
<div id="b32e7ac8" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span><span class="op">-</span>ensemble.mean(<span class="dv">0</span>), ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Ensemble average'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.plot(p_trajectory[:, <span class="dv">0</span>], ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'State distribution'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">500</span>], [pstar[<span class="dv">0</span>], pstar[<span class="dv">0</span>]], <span class="st">'-'</span>, color<span class="op">=</span><span class="st">'k'</span>, label<span class="op">=</span><span class="st">'Stationary distribution'</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time steps $t$'</span>)<span class="op">;</span> plt.ylabel(<span class="st">'Average system state $s$'</span>)<span class="op">;</span> plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02.04-StateTransitions_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>How does this result depend on the model parameters, the collapse probability <span class="math inline">\(p_c\)</span> and the recovery probability <span class="math inline">\(p_r\)</span>?</p>
<p>Can we <strong>compute the stationary distribution analytically</strong>, i.e., can we derive a mathematical equation which says how the stationary distribution depends on the collapse probability <span class="math inline">\(p_c\)</span> and the recovery probability <span class="math inline">\(p_r\)</span>?</p>
</section>
<section id="analytical-stationary-distribution" class="level3">
<h3 class="anchored" data-anchor-id="analytical-stationary-distribution">Analytical <strong>stationary distribution</strong></h3>
<p>Fortunately, we can use Python’s library for basic symbolic calculations <code>sympy</code>, to compute the eigenvectors of the transition matrix symbolically.</p>
<div id="c4d53176" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p_c, p_r <span class="op">=</span> sp.symbols(<span class="st">"p_c, p_r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e3f3a85b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>T_ <span class="op">=</span> sp.Matrix([[<span class="dv">1</span><span class="op">-</span>p_c, p_c],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                [p_r, <span class="dv">1</span><span class="op">-</span>p_r]])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>T_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="19">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}1 - p_{c} &amp; p_{c}\\p_{r} &amp; 1 - p_{r}\end{matrix}\right]\)</span></p>
</div>
</div>
<p>Applying the <code>.eigentvects()</code> method</p>
<div id="d4b80fdb" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>T_.T.eigenvects()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>[(1,
  1,
  [Matrix([
   [p_r/p_c],
   [      1]])]),
 (-p_c - p_r + 1,
  1,
  [Matrix([
   [-1],
   [ 1]])])]</code></pre>
</div>
</div>
<p>shows us which eigenvector corresponds to the eigenvalue 1. Upon normalizing the eigenvector, we obtain the analytical stationary distribution,</p>
<div id="da6b2e6a" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pstar_ <span class="op">=</span> T_.T.eigenvects()[<span class="dv">0</span>][<span class="dv">2</span>][<span class="dv">0</span>] <span class="co"># selecting the eigenvector</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pstar_ <span class="op">=</span> pstar_ <span class="op">/</span> (pstar_[<span class="dv">0</span>] <span class="op">+</span> pstar_[<span class="dv">1</span>]) <span class="co"># normalizing the eigenvector</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>sp.simplify(pstar_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="21">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{p_{r}}{p_{c} + p_{r}}\\\frac{p_{c}}{p_{c} + p_{r}}\end{matrix}\right]\)</span></p>
</div>
</div>
<p><strong>Thus, only the fraction of <span class="math inline">\(p_c\)</span> and <span class="math inline">\(p_r\)</span> determines the stationary distribution.</strong> The stationary distribution remains the same, if you multiply the collapse and recovery probabilities by the same factor. The fraction of the stationary distribution in the prosperous state is proportional to the recovery probability, <span class="math inline">\(p_r\)</span>, i.e., the probability to enter the prosperous state from the degraed state. And vice versa, the fraction of the stationary distribution in the degraded state is proportional to the collapse probability, <span class="math inline">\(p_c\)</span>, i.e., the probability to enter the degraded state from the prosperous state.</p>
<p>Last, to compare this analyitical solution with the numerical calculation we insert the values for <span class="math inline">\(p_c\)</span> and <span class="math inline">\(p_r\)</span> into the analytical solution.</p>
<div id="ca859dce" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pstar_.subs(p_c, pc).subs(p_r, pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="22">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}0.166666666666667\\0.833333333333333\end{matrix}\right]\)</span></p>
</div>
</div>
<div id="d689b009" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;slideshow&quot;,&quot;value&quot;:{&quot;slide_type&quot;:&quot;fragment&quot;}}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pstar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([0.16666667, 0.83333333])</code></pre>
</div>
</div>
<p>We observed the the <strong>statistical equilibrium</strong> in the Markov chain simulation and calculated the long-run stationary distribution both numerically and symbolically. But what are the <strong>conditions that such a unique statistical equilibrium exists?</strong></p>
</section>
<section id="stationary-distribution-existence" class="level3">
<h3 class="anchored" data-anchor-id="stationary-distribution-existence">Stationary distribution | <strong>Existence</strong></h3>
<p>Any Markov model with a <strong>finite set of states</strong>, <strong>fixed transition probabilities</strong> between them, the <strong>potential to move from any state to any other</strong> in a series of transitions, and <strong>no fixed cycles</strong> between states converges to a unique equilibrium. These are the conditions of the Perron-Frobenius Theorem <span class="citation" data-cites="Page2018">(<a href="References.html#ref-Page2018" role="doc-biblioref">Page, 2018</a>)</span>.</p>
<blockquote class="blockquote">
<h4 id="perron-frobenius-theorem" class="anchored">Perron-Frobenius Theorem</h4>
<p>A Markov process converges to a unique statistical equilibrium provided it satisfies four conditions:</p>
<ul>
<li><strong>Finite set of states</strong>: <span class="math inline">\(\mathcal S = {S_1, S_2, \dots, S_Z}\)</span>.</li>
<li><strong>Fixed transition rule</strong>: The probabilities of moving between states are fixed, for example, the probability of transitioning from state <span class="math inline">\(S_i\)</span> to state <span class="math inline">\(S_j\)</span> equals <span class="math inline">\(T(S_i, S_j)\)</span> in every period.</li>
<li><strong>Ergodicity</strong> (state accessibility): The system can get from any state to any other through a series of transitions.</li>
<li><strong>Noncyclic</strong>: The system does not produce a deterministic cycle through a sequence of states.</li>
</ul>
</blockquote>
<p>The theorem implies that <strong>if those four assumptions are satisfied</strong>, the <em>initial state</em>, <em>history</em>, and <em>interventions that change the state</em> <strong>cannot change the long-run equilibrium</strong>.</p>
<p>The unique statistical equilibrium implies that long-run distributions of outcomes cannot depend on the initial state or on the path of events. In other words, initial conditions do not matter, and history does not matter in the long run. Nor can interventions that change the state matter. Any one-time change in the state of a system has at most a temporary effect.</p>
<p>For example,</p>
<ul>
<li>if nations move between dictatorships and democracies according to fixed probabilities, then interventions that impose or encourage democracies in some countries have no long-term effects.</li>
<li>If fluctuations in dominant political ideologies satisfy the assumptions, then history cannot influence the long-run distribution over ideologies.</li>
<li>And if a person’s mental state can be represented as a Markov model, then words of encouragement or supportive gestures have no long-run impact.</li>
</ul>
<p>The <strong>takeaway</strong> from the theorem should not be that history cannot matter but that <strong>if history does matter, one of the model’s assumptions must be violated</strong>.</p>
<p>Two assumptions—the finite number of states and no simple cycle—almost always hold.</p>
<p><strong>Ergodicity</strong> can be violated. However, in practice, it is often possible to ensure ergodicity by adding a tiny transition probability between states that are not directly connected. This tiny transition probability can justified by our lack of knowledge about the system.</p>
<p>Thus, the <strong>assumption of fixed transition probabilities</strong> between states is the least likely to be valid. When history is important, something must alter the transition probabilities.</p>
<p>For example, take the issue of assisting families in escaping poverty. The forces that create social inequality have proven immune to policy interventions. In Markov models interventions that change families’ states—such as special programs for underperforming students or a one-day food drive—can provide temporary boosts. They cannot change the long-run equilibrium. In contrast, interventions that provide resources and training that improve people’s ability to keep jobs, and therefore change their probabilities of moving from employed to unemployed, could change long-run outcomes <span class="citation" data-cites="Page2018">(<a href="References.html#ref-Page2018" role="doc-biblioref">Page, 2018</a>)</span>.</p>
<p>We investigated the long-run behavior of the Markov chain model. But <strong>what about the short-term behavior</strong>?</p>
</section>
</section>
<section id="transient-behavior" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="transient-behavior"><span class="header-section-number">5.5</span> Transient behavior</h2>
<p>We found that our example system’s statistical equilibirum, its stationary distribution, depends only on the fraction of the collapse and recovery probabilities, <span class="math inline">\(p_c\)</span> and <span class="math inline">\(p_r\)</span>.</p>
<p>To investigate the short-term behavior before the evolution of the state distribuion reaches its equlibirum, we create different pairs of collapse and recovery probabilities while keeping their fraction constant.</p>
<div id="caef0a14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;slideshow&quot;,&quot;value&quot;:{&quot;slide_type&quot;:&quot;fragment&quot;}}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>prs <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.003</span>, <span class="fl">0.001</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pcs <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> prs</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>pcs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([0.5  , 0.15 , 0.05 , 0.015, 0.005])</code></pre>
</div>
</div>
<p>We can insert these in the <code>sympy</code> matrix as follows,</p>
<div id="6f2e33b2" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>np.array(T_.subs(p_c, pc).subs(p_r, pr), dtype<span class="op">=</span><span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([[0.95, 0.05],
       [0.01, 0.99]])</code></pre>
</div>
</div>
<section id="simulating-different-transition-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="simulating-different-transition-probabilities">Simulating different transition probabilities</h3>
<p>It is convenient to define a function to obtain the time evolution for the state distributions.</p>
<div id="a0aa9431" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_distribution_trajectory(T):  <span class="co"># Transition matrix </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    ps <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    p_trajectory <span class="op">=</span> []</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>): </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        ps <span class="op">=</span> ps <span class="op">@</span> T</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        p_trajectory.append(ps)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(p_trajectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With that function, we simply compute the time evolution of the state distribution for the different values of <span class="math inline">\(p_r\)</span> and <span class="math inline">\(p_c\)</span>.</p>
<div id="c853384c" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>trajs <span class="op">=</span> []</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pr, pc <span class="kw">in</span> <span class="bu">zip</span>(prs, pcs):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    Tmat <span class="op">=</span> np.array(T_.subs(p_c, pc).subs(p_r, pr), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    trajs.append(compute_distribution_trajectory(Tmat))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>np.array(trajs).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>(5, 500, 2)</code></pre>
</div>
</div>
</section>
<section id="visualizing-distribution-trajectories" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-distribution-trajectories">Visualizing distribution trajectories</h3>
<div id="d2390d28" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, traj <span class="kw">in</span> <span class="bu">enumerate</span>(trajs):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    plt.plot(traj[:, <span class="dv">0</span>], ls<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'.'</span>, label<span class="op">=</span>prs[i])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">500</span>], [pstar[<span class="dv">0</span>], pstar[<span class="dv">0</span>]], <span class="st">'-'</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)<span class="op">;</span> plt.xlabel(<span class="st">'Time steps'</span>)<span class="op">;</span> plt.legend(title<span class="op">=</span><span class="st">'Recovery probability'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02.04-StateTransitions_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>The smaller the transition probabilities, the longer it takes to reach the stationary distribution.</strong></p>
</section>
</section>
<section id="timescales" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="timescales"><span class="header-section-number">5.6</span> Timescales</h2>
<p>Sometimes, it can be interesting or adquate to think about the typical <strong>timescales</strong> of a system. For example, consider the typical timescale it takes a system to tip into another state. <strong>How can we identify the notion of timescale in a Markov chain?</strong></p>
<p>Let us identify a notion of timescale as the average <strong>number of time steps</strong> spend in a particular state before a transition occurs. How can we calculate it?</p>
<p>We will first compute these timescales numerically, showcasing somewhat more advanced maniumplation using Python. Then we turn to an analytical formula and compare the results.</p>
<section id="numerical-computation" class="level3">
<h3 class="anchored" data-anchor-id="numerical-computation">Numerical computation</h3>
<p>To investigate this question nummerically, we re-create a (long) trajectory of states.</p>
<div id="f83bc6aa" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pc <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>pr <span class="op">=</span> <span class="fl">0.04</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> np.array(T_.subs(p_c, pc).subs(p_r, pr), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>trajectory <span class="op">=</span> []</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500000</span>):</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> np.random.choice([<span class="dv">0</span>,<span class="dv">1</span>], p<span class="op">=</span>T[state])</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    trajectory.append(state)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>trajectory <span class="op">=</span> np.array(trajectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Looking at the first 100 states</p>
<div id="8e931d8a" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>shorttraj <span class="op">=</span> trajectory[:<span class="dv">99</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>shorttraj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1])</code></pre>
</div>
</div>
<p>How do we obtain the lengths of the <code>0</code> and <code>1</code> sequences?</p>
<p>We can subtract the trajectory by itsel with an offset of one time step. For the first 100 time steps, this looks like</p>
<div id="4473ca89" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>shorttraj[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> shorttraj[<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([-1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  1,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,
        0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0])</code></pre>
</div>
</div>
<p>With <code>np.nonzero</code> with obtain the ‘cutpoints’ where the states change,</p>
<div id="df12f9f2" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cutpoint <span class="op">=</span> np.nonzero(trajectory[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> trajectory[<span class="dv">1</span>:])</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cutpoint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>(array([     0,     19,     26, ..., 499904, 499960, 499985]),)</code></pre>
</div>
</div>
<p>With <code>np.diff</code>, we obtain the differences between the cutpoints. These are the lengths of the sequences.</p>
<div id="6bd9765e" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lengths <span class="op">=</span> np.diff(cutpoint)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>lengths </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[19,  7, 22, ..., 10, 56, 25]])</code></pre>
</div>
</div>
<p>The lengths of the prosperous states are in the odd elements of the <code>lengths</code> iterable. Taking the average yields</p>
<div id="d4191049" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>length_prosperous <span class="op">=</span> np.mean(lengths[<span class="dv">0</span>][<span class="dv">1</span>::<span class="dv">2</span>])</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>length_prosperous</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>4.982404866992724</code></pre>
</div>
</div>
<p>The lengths of the degraded states are in the even elements of the <code>lengths</code> iterable. Taking the average yields</p>
<div id="c3eb89e0" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>length_degraded <span class="op">=</span> np.mean(lengths[<span class="dv">0</span>][<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>length_degraded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>24.838959799594416</code></pre>
</div>
</div>
</section>
<section id="analytical-computation" class="level3">
<h3 class="anchored" data-anchor-id="analytical-computation">Analytical computation</h3>
<p>The average number of time steps <span class="math inline">\(T\)</span> it takes until a transition occurs, given a transition probability <span class="math inline">\(p\)</span>, is <span class="math display">\[
T = \sum_{n=0}^\infty n (1-p)^{n-1} p = \frac{1}{p}.
\]</span></p>
<p>For a sequence of length <span class="math inline">\(n\)</span> it took <span class="math inline">\(n-1\)</span> time steps to remain in state <span class="math inline">\(s\)</span> before the transition. The probability of remaining in state <span class="math inline">\(s\)</span> for <span class="math inline">\(n-1\)</span> time steps is <span class="math inline">\((1-p)^{n-1}\)</span>. At the <span class="math inline">\(n\)</span>’th time step, the transition occurs with probability <span class="math inline">\(p\)</span>.</p>
<p>This is the expected value of a geometric random variable with parameter <span class="math inline">\(p\)</span>. The number of steps <span class="math inline">\(T\)</span> spent in state <span class="math inline">\(s\)</span> before a transition occurs can be thought of as the number of trials until the first success in a sequence of Bernoulli trials, where each trial has a success probability of <span class="math inline">\(p\)</span> of transitioning out of <span class="math inline">\(s\)</span>. In probability theory, the number of trials required to get the first success in such a situation is described by a geometric random variable. It expected value is <span class="math inline">\(\mathbb{E}[T] = 1/p\)</span>.</p>
<p>For the prosperous state, we have</p>
<div id="af1307f2" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">/</span>pc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>5.0</code></pre>
</div>
</div>
<p>compared to our numerical estimate</p>
<div id="a948c25c" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>length_prosperous</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>4.982404866992724</code></pre>
</div>
</div>
<p>For the degraded state, we have</p>
<div id="99cf7644" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">/</span>pr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>25.0</code></pre>
</div>
</div>
<p>compared to our numerical estimate</p>
<div id="114f1fdb" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>length_degraded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>24.838959799594416</code></pre>
</div>
</div>
<p>Thus, the average number of time steps before a transition occurs equals the inverse transition probability <span class="math inline">\(1/p\)</span>. This gives us an indication of the typical timescale of the system.</p>
</section>
<section id="example-regime-shifts-timescales" class="level3">
<h3 class="anchored" data-anchor-id="example-regime-shifts-timescales">Example | <strong>Regime shifts timescales</strong></h3>
<p>Typical collapse and recovery timescales of regime shifts from the <a href="https://www.regimeshifts.org/">Regime Shifts Database</a> have been mapped to the transition probabilities of a Markov chain in this way <span class="citation" data-cites="BarfussEtAl2024">(<a href="References.html#ref-BarfussEtAl2024" role="doc-biblioref">Barfuss et al., 2024</a>)</span> (<a href="#fig-Markov-timescales" class="quarto-xref">Figure&nbsp;<span>5.5</span></a>).</p>
<div id="fig-Markov-timescales" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Markov-timescales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/02.04-Timescales.dio.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Markov-timescales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Timescales
</figcaption>
</figure>
</div>
</section>
</section>
<section id="learning-goals-revisited" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="learning-goals-revisited"><span class="header-section-number">5.7</span> Learning goals <strong>revisited</strong></h2>
<ul>
<li>We introduced the <em>components of a Markov chain model</em> and covered how the model relates to gernal dynamic system models to place this model in the context of integrated nature-society models.</li>
<li>We simulated and visualized <em>Markov chain models</em> in multiple ways: stochastically, with ensembles, and via its state distribution to understand how the model behaves.</li>
<li>We computed the <em>stationary distribution</em> of a Markov chain model numerically, analytically and explain the conditions for its existence to understand the long-term behavior of the model.</li>
<li>We investigated the <em>transient behavior</em> of a Markov chain model to understand the short-term behavior of the model.</li>
<li>We computed the <em>typical timesacle</em> of a Marko chain transition to relate the model to real-world systems.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-BarfussEtAl2024" class="csl-entry" role="listitem">
Barfuss, W., Donges, J., &amp; Bethge, M. (2024). <em>Ecologically-mediated collective action in commons with tipping elements</em>. OSF. <a href="https://doi.org/10.31219/osf.io/7pcnm">https://doi.org/10.31219/osf.io/7pcnm</a>
</div>
<div id="ref-BiggsEtAl2021" class="csl-entry" role="listitem">
Biggs, R., Preiser, R., de Vos, A., Schlüter, M., Maciejewski, K., &amp; Clements, H. (2021). <em>The <span>Routledge Handbook</span> of <span>Research Methods</span> for <span>Social-Ecological Systems</span></em> (1st ed.). Routledge. <a href="https://doi.org/10.4324/9781003021339">https://doi.org/10.4324/9781003021339</a>
</div>
<div id="ref-DanielEtAl2016" class="csl-entry" role="listitem">
Daniel, C. J., Frid, L., Sleeter, B. M., &amp; Fortin, M.-J. (2016). State-and-transition simulation models: A framework for forecasting landscape change. <em>Methods in Ecology and Evolution</em>, <em>7</em>(11), 1413–1423. <a href="https://doi.org/10.1111/2041-210X.12597">https://doi.org/10.1111/2041-210X.12597</a>
</div>
<div id="ref-Muller-HansenEtAl2017a" class="csl-entry" role="listitem">
Müller-Hansen, F., Cardoso, M. F., Dalla-Nora, E. L., Donges, J. F., Heitzig, J., Kurths, J., &amp; Thonicke, K. (2017). A matrix clustering method to explore patterns of land-cover transitions in satellite-derived maps of the <span>Brazilian Amazon</span>. <em>Nonlinear Processes in Geophysics</em>, <em>24</em>(1), 113–123. <a href="https://doi.org/10.5194/npg-24-113-2017">https://doi.org/10.5194/npg-24-113-2017</a>
</div>
<div id="ref-Page2018" class="csl-entry" role="listitem">
Page, S. E. (2018). <em>The model thinker: <span>What</span> you need to know to make data work for you</em>. Basic Books.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02.03-Resilience.html" class="pagination-link" aria-label="Resilience">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resilience</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-TargetEquilibria.html" class="pagination-link" aria-label="Target Equilibria">
        <span class="nav-page-text">Target Equilibria</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>